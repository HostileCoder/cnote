Designing and Implementing Multibeam Smart Antennas 
for High Bandwidth VA V Communications using FPGAs 
John C. Porcello 
Senior Member IEEE, 
Senior Research Engineer 
Georgia Tech Research Institute (GTRI) 
John.Porcello@gtri.gatech.edu 
Abstract- AL[`R´LWLX_]g MY´g QRPQg IHXKbRK_Qg D2Eg
 JYWW`XRJH_RYX]g H´Lg YOLXg XLJL]]H´dg RXg Y´KL´g _Yg WYaLg
 TH´PLg HWY`X_]g YMg WR]]RYXg RXMY´WH_RYXg _Y'M´YWg D]L´]g RXg
 ´LHT%_RWL&g CQLg MYJ`]g YMg _QR]g ZHZL´g R]g HX_LXXHg
 ILHWMY´WRXPg MY´g ZYRX_%_Y%ZYRX_#g QRPQg IHXKbRK_Qg D2gEg
 JYWW`XRJH_RYX]g RXg Y´KL´g _Yg YZ_RWRfLg _´HX]WR_g HXKg
 ´LJLRaLg ZYbL´g HXKg ]`ZZY´_g QRPQg KH_Hg _Q´Y`PQZ`_g
 JYWW`XRJH_RYX]&g BZLJRNJHTTd#g _QR]g ZHZL´g TYYS]g H_g _QLg
 KL]RPXg HXKg RWZTLWLX_H_RYXg YMg =`:_RILHWg BWH´_g
 2X_LXXH]g _Yg RWZTLWLX_g HX_LXXHg ILHWgMY´WRXPg RXg HXg
 HL´Y]ZHJLg JYWW`XRJH_RYX]g LXaR´YXWLX_&g CQLg BWH´_g
 2X_LXXHg R]g JYX_´H]_LKg HPHRX]_g 8H]_g 8Y`´RL´g C´HX]MY´Wg
 !88C"g IH]LKg ILHWMY´WRXPg RXg Y´KL´g _Yg [`HX_RMdg _QLg
 RXJ´LH]Lg RXg IY_Qg JYWZ`_H_RYXHTg TYHKg HXKg 8?92g
 ´L]Y`´JL]g ´L[`R´LKg MY´g W`:_RILHWg HKHZ_RaLg ]RPXHTg
 Z´YJL]]RXPg RXg _QLgBWH´_g2X_LXXH&g CQLgZHZL´gILPRX]gbR_Qg
 HXg YaL´HTTg KR]J`]]RYXg YMg BWH´_g 2X_LXXHg KL]RPXg HXKg
 PLXL´HTg ILHWgMY´WRXPg R]]`L]g RXg QRPQg IHXKbRK_Qg
 JYWW`XRJH_RYX]&g ;WZY´_HX_g KL]RPXg JYX]RKL´H_RYX]g ]`JQg
 H]g Z´YJL]]RXPg JYWZTLcR_dg RXg Hg JYX]_´HRXLKg BRfL#g FLRPQ_g
 HXKg ?YbL´g !BFH?"g LXaR´YXWLX_g H´Lg KR]J`]]LK&g CQLg
 MYJ`]g YMg _QLg ZHZL´g R]g bR_Qg ´L]ZLJ_g _Yg KL]RPXg HXKg
 RWZTLWLX_H_RYXg YMg KRPR_HTg ILHWgMY´WRXPg bRKLIHXKg
 JYWW`XRJH_RYX]gbHaLMY´W]g`]RXPg8?92]&g 2g=`:_RILHWg
 CRWLg 6LTHdg LTLWLX_g R]g RX_´YK`JLKg IH]LKg YXg <HP´HXPLg
 ;X_L´ZYTH_RYX&g 6L]RPXg KH_Hg MY´g =`:_RILHWg BWH´_g
 2X_LXXH]g RXg 8?92]g R]g Z´YaRKLKg RXg _QLg ZHZL´g H]g bLTTg H]g
 ´LML´LXJLg JR´J`R_]g MY´g RWZTLWLX_H_RYX&g 8RXHTTd#g HXg
 LcHWZTLg =`T_RILHWg BWH´_g 2X_LXXHg KL]RPXg R]g Z´YaRKLKg
 IH]LKgYXg HgGRTRXcgER´_Lc%/g8?92&g CQLg=`:_RILHWgBWH´_g
 2X_LXXHg LcHWZTLg KL]RPXg RTT`]_´H_L]g _QLg JYXJLZ_]g
 KR]J`]]LKg RXg _QLg ZHZL´g HXKg Z´YaRKL]g KL]RPXg RX]RPQ_g RX_Yg
 =`T_RILHWg BWH´_g 2X_LXXHg RWZTLWLX_H_RYXg M´YWg _QLg
 ZYRX_g YMg aRLbg YMg RWZTLWLX_H_RYXg JYWZTLcR_d#g ´L[`R´LKg
 QH´KbH´L#gHXKgYaL´HTTg]d]_LWgZL´MY´WHXJLgPHRX&g
 TABLE OF CONTENTS 
)&gOVERVIEW AND SCOPE &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&g)g
 *&gSMART ANTENNAS AND 88CgBASED BEAMFORMING &&&&&&g+g
 +&g2gMUL TIBEAM 648gSTRUCTURE IN 8?92^g&&&&&&&&&&&&&&&&&g-g
 ,&gMULTIBEAM SMART ANTENNA DESIGN &&&&&&&&&&&&&&&&&&&&&&&&&&g/g
 -&gEXAMPLE MUL TIBEAM SMART ANTENNA DESIGN &&&&&&&&&g1g
 .&gCONCLUSIONS &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&g))g
 REFERENCES &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&g)*g
 BIOGRAPHY &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&g)*g
 978-1-4673-1813-6/13/$31.00 ©20131EEE 
1. OVERVIEW AND SCOPE 
In various UA V missions there is a consistent need for high?
 throughput communications in order to move large amounts 
of mission data to/from Users in real-time. Often this 
requires wideband communications architectures such as 
OFDM (multicarrier system) or several single carrier 
channels, and optimizing several communication system 
parameters, including the antenna beam pattern, to achieve 
required performance. This paper considers the scenario of a 
UA V or similar aerospace communications platform, which 
must perform wideband digital beamforming to achieve high 
throughput communications. In the context of this scenario 
Spatial filtering using antenna beamforming can provide 
communication system performance gains in terms of Space 
Division Multiple Access (SDMA) as well as Spatial 
Filtering for Interference Reduction (SFIR). 
The context of antenna beamforming to perform spatial 
filtering for wideband communications requires some 
clarification. Generally, antenna apertures can be grouped in 
capability based on (a) the type and number of antenna 
elements, (b) the method used to switch or steer antenna 
beams, which implies the level of complexity in the 
architecture as well as a switching speed, (c) the 
instantaneous bandwidth of the antenna aperture and (d) the 
signal processing used for the antenna aperture. This also 
implies an architecture complexity based on the number of 
steered antenna beams as well as the number of antenna 
nulls to reduce the effect of interferers. The latter capability 
reflects whether or not the antenna aperture is adaptive to 
the environment in which it is operating. 
Furthermore from [1] we can defme the fractional bandwidth 
of the antenna aperture: 
BWRX 
(1) 
fcarrier 
where BWFrac is the fractional bandwidth, BW RX is the 
received signal bandwidth and harrier is the carrier 
frequency. Fractional bandwidth impacts array design. 
Classic narrowband array design often uses phase shifters to 
Steering Vector 
Time Delay f-j-.-{ 
Time Delay f-jf---r---+ 
Tim e Del ay f-t--+---+---.I 
Smart Antenna 
Output y[n] 
Time Delay 1---+--+--+--+--.1 
CMACC 
Beam Steering F===='--? 
Delays 
(A) 
Multiply 
(B) 
Weighb 
FFT Beamformer 
Output y[n] 
8RP`´Lg ) $ !H"gBWH´_g2X_LXXHgH´JQR_LJ_`´Lg`]RXPgBHWZTLg=H_´Rcg;XaL´]RYXgHXKg!I"g88CgIH]LKgILHWMY´WRXP&g
 implement corresponding delays such that the elements are 
added in correct phase for a given beam steer. As fractional 
bandwidth increases, narrowband design assumptions based 
on single frequency phase shifters are no longer valid. A 
wideband signal from a given direction of arrival, appears to 
arrive from an angular region in the narrowband array. The 
phenomenon is known as dispersion. 
Fractional bandwidth is an important performance parameter 
in Smart Antennas and provides some insight into array 
capabilities. Whereas wideband radar systems may have 
very large instantaneous bandwidths on the order of an 
octave or more, wideband communications systems may 
have fractional bandwidths closer to narrowband arrays. For 
example, a Smart Antenna for wideband communications 
with an instantaneous bandwidth of 40 MHz and carrier 
frequency of 2.5 GHz has a fractional bandwidth of only 
1.6%. 
2 
Arrays multiply the incident signal by beamformer weights, 
for each array element [2]. Smart Antennas adapt the 
weights based on the environment (interference, etc.) using a 
given optimal criteria [1][3][9]. An equation for obtaining 
an estimate of beam former weights for an adaptive array can 
be described by the optimum Weiner solution: 
? kR?-1 W= S (2) 
? R?-I where w, is an estimate of the beamformer weights, 
represents the inverse of the sample covariance matrix, S 
represents the spatial steering vector and k is a scale factor. 
The sample covariance matrix is estimated from the received 
data and contains information about the environment. 
A dynamic aerospace environment requires that this process 
of determining beamformer weights be continually updated 
to adapt to changing Angle-Of-Arrival (AOA) of signals and 
interferers. It should be noted here that for Smart Antennas 
that implement digital beamforming at the element level, 
updating the beamformer weights in real-time constitutes the 
bulk of the signal processing load. As the number of 
elements in the array increases, larger amounts of data need 
to require real-time processing. Note that the convergence 
rate of a real-time, adaptive system is an important 
performance metric. 
Obtaining a good sample covariance matrix estimate and 
then inverting the sample covariance matrix, referred to as 
Sample Matrix Inversion (SMI) or Direct Matrix Inversion 
(DMI) [3], can require substantial FPGA resources. The 
number of complex multiplies and memory depends on the 
array size, method used to obtain the weights including any 
algorithm computational load reduction techniques, and the 
FPGA implementation. Among the various methods to 
obtain beam former weights the disadvantages of SMI 
include increasing complexity with array size and possible 
numerical instability associated with finite precision 
arithmetic when inverting a matrix. 
Fast Fourier Transform (FFT) based methods, or frequency 
domain beamforming, [4][5][6] refers to the use of the FFT 
as the implementation method to accomplish digital 
beamforming. For the purposes in this paper, the FFT is 
synonymous with the Discrete Fourier Transform (DFT) and 
represents the efficient FPGA implementation of the DFT 
spatial filter for all but the smallest array sizes. Often in the 
literature this approach is in the context of a simple Uniform 
Linear Array (ULA). Furthermore, FFT based methods are 
often used as an approach to accomplish AOA. In both 
contexts, FFT based methods are non-adaptive systems that 
use the FFT to either perform digital beamsteering or 
provide AOA information to accomplish the beamsteering 
function, respectively. As simple FFT based beamforming 
is not adaptive and does not require an estimate and 
correction for the received signal environment, the signal 
processing load and the implementation complexity is not as 
high as it is for the Smart Antenna. However, when there is a 
system requirement to operate in an environment that 
contains interference (i.e. we want to null out co-channel 
interference, etc.), Smart Antennas represent a capable 
solution. 
The purpose of this paper is to contrast FPGA 
implementation of a Smart Antenna against FFT based 
methods in the design space of a SWaP constrained high 
bandwidth communications payload for a UAV. In this 
paper the implementation focuses on delay-and-sum digital 
beamforming to support wideband communications. 
For the purposes in this paper, Smart Antennas have 
adaptive capabilities and are implemented using digital 
beamforming at the element level. Furthermore, both Smart 
3 
Antennas and FFT based methods need to compensate for 
aerospace platform motion and User motion by continually 
adjusting beam position. This requires constantly looking at 
the AOA of the received signal and correcting the spatial 
steering vector (the beam steer). Errors or significant latency 
in this process result in a tracking error. When the array 
beamwidth is narrow and/or the update rate is low, this loss 
may need to be included as a beam pointing error in the link 
budget. 
For the purposes in this paper, we will consider the delay 
and sum beamformer at the element level using time domain 
interpolation digital beamforming [4] for a Smart Antenna in 
a fairly benign communications environment. For the 
discussion in this paper, the array sizes are relatively small 
and the design space of reducing the processing load using 
subarrays will not be considered. It will be assumed that the 
Smart Antenna has sufficient degrees of freedom to meet 
requirements. This paper will also neglect RF/Microwave 
transmit/receive (T/R) hardware issues for multi carrier 
operation and focus on digital signal processing in the 
FPGA. Specifically, the challenging task of achieving high 
T/R isolation to support simultaneous transmit receive 
operations will be neglected. It should also be noted that the 
discussion in this paper assumes the User equipment in the 
far field of the antenna such that array design is based on an 
incident Electromagnetic (EM) plane wave. 
2. SMART ANTENNAS AND FFT BASED 
BEAMFORMING 
Smart Antennas may use various algorithms to optimize the 
estimate of the beamforming weights. Various approaches to 
forming the covariance matrix have advantages and 
disadvantages and a discussion of the many approaches is 
beyond the scope of this paper but can be found in several of 
the references. In this paper we will focus on the SMI 
approach, also called a block adaptive implementation since 
it uses a block of sampled data to obtain the covariance 
matrix. Specifically, we obtain the covariance matrix 
estimate from: 
(3) 
This represents the maximum likelihood estimate of the 
covariance matrix using the average outer products of the 
array snapshots. The accuracy of this sampled matrix is 
sensitive to the length of the data block (the size of K or the 
number of samples) and the instantaneous environment 
during the interval when the sampled data is collected. 
Furthermore the length of the data block also impacts the 
side lobe level which can be achieved. Reed, Mallett, and 
Brennan [8] showed that for an array of M sensors, the 
Signal-to-Interference Noise ratio (SINR) is within 3 dB of 
optimal when the length of the data block meets the 
following criteria: 
K?:.2M -3 (4) 
Known as the RMB rule, K should be greater than or equal 
to 2M-3 [9] with larger values of K are required to achieve 
performance higher than 3 dB of optimal. It should also be 
noted that the side lobe level can be significantly reduced 
using diagonal loading. There are detailed issues 
surrounding when to take the sampled data snapshots (i.e., 
collect the training data) [I]. Ideally the desired signal 
would not be present and when the training data is collected 
to obtain the best estimate of the noise and any interference. 
To summarize at this point, a simple algorithm to implement 
the Smart Antenna using SMI would consist of Complex 
Multiply and Accumulate (CMACC) operations over the 
block adaptive length K to estimate the sample covariance 
matrix, followed by a matrix inversion operation to obtain 
the inverse sample covariance matrix. Complex 
multiplications are then used to multiply the inverse sample 
covariance matrix with the spatial steering vector to obtain 
an estimate of the beamforming weights. Finally complex 
multiply operations are used at each element in the smart 
antenna to multiply the beamforming weights with the 
individual channels in the delay and sum beamformer. The 
resulting output in each channel is summed together to 
obtain the beam former output y(t). 
In order to contrast the Smart Antenna we will consider the 
FFT beamformer described by Brigham [6]. The FFT 
beamformer described here performs processing in the 
frequency domain to implement the equivalent of delay-sum 
digital beamforming. Recall the Fourier transform of a time 
shift T in the time domain is as follows: 
(5) 
This FFT Beamformer is implemented by performing an 
FFT on each sensor output followed by a complex multiply 
on each FFT output. The complex mUltiply is adjusted for 
each sensor from equation 5 above based on the sensor 
spacing, required delay (T varies across each sensor output) 
and a frequency estimate. Each of the output products is then 
summed together followed by an Inverse FFT operation to 
obtain the beam former output in the time domain y(t). 
Figure la shows a high level block diagram of the Smart 
Antenna (adaptive processing) and Figure Ib shows the 
conventional FFT beamformer. The time delay elements in 
the Smart Antenna are described in section 3. In terms of 
quantifying computational load for FPGA implementation 
we can estimate the number of arithmetic operations 
4 
required for each design. From Figure la it can be seen that 
for an array of M sensors, the adaptive processing load 
requires KM 2 complex operations for the CMACCs 
followed by inversion of an MxM matrix (assuming 
M3 complex operations), followed by M2 complex 
operations to generate the weights and concluding with 2M?
 J complex operations to complete the signal processing 
chain. Implementing the time delay elements and generating 
the spatial steering vector also require operations. 
An estimate of computational resources can be performed 
for Figure I b. Assuming an FFT computational load of 
N log2( N ) operations with 256 point FFTs for the FFTs in 
Figure Ib followed by 2M-J complex operations and 
another N log2( N ) + (M-I) operations to complete this 
processing chain. Finally, implementing the beam steering 
delays will also require complex operations. 
In order to contrast the two architectures, Figure 2 plots the 
computational load for processing at the array element level 
of a Smart Antenna with a block length of K = 100 and an 
FFT beamformer using an FFT size of 256. The y-axis 
shows the log scale of Millions of Operations (MOps). 
Figure 3 shows the computational processing load 
comparison for K = 500 and Figure 4 shows the 
computational processing load for K = 1000. 
Element Level Processing Computational Load: Smart Antenna vs FFT Beamformer , 
? 
Co 
10 
10 
? 10 
10 
, 
0 
? , 
// 
, Y 10 0 
/ 
-
 K = 100 ? 
./ 
),;' =? 
-
 ---
 20 40 60 80 
Array Size 
100 120 140 
8RP`´Lg *g - 7TLWLX_g <LaLTg 5YWZ`_H_RYXHTg ?´YJL]]RXPg
 <YHKg JYWZH´R]YXg MY´g _QLg BWH´_g 2X_LXXHg HXKg 88Cg
 4LHWMY´WL´gMY´gK = )((&g
 The computational load comparison graphs in Figure 2, 
Figure 3 and Figure 4 provides design insight with respect to 
the computational cost of adding basic adaptive signal 
processing to the wideband communications platform. For a 
given airborne signal processing hardware architecture, the 
increased computational load provided in these graphs can 
be used to directly calculate increase in SWaP requirements 
based on the number of arithmetic operations required to 
meet real-time performance requirements. It is interesting to 
note the increased computational load related to block size 
K. For large array sizes the increase in computational 
complexity for adaptive signal processing requires 
substantial increase in SWaP compared to the FFT 
beamformer. 
Element Level Processing Computational Load: Smart Antenna vs FFT Beamformer 
10' 
10' 
K = 500 
/ 
'" .'l 
I 
10 , I 
/ 
, I 
20 
....... 
/"" 
I?-
 ' 
-
 .---
 40 60 80 
Array Size 
100 120 140 
8RP`´Lg +g- 7TLWLX_g <LaLTg5YWZ`_H_RYXHTg ?´YJL]]RXPg
 <YHKg JYWZH´R]YXg MY´g _QLg BWH´_g 2X_LXXHg HXKg 88Cg
 4LHWMY´WL´gMY´gK = -((&g
 Element Level Processing Computational Load: Smart Antenna vs FFT Beamformer 
10;??? 
I 
10-' I --
 10-' , o 20 40 60 80 
Array Size 
100 120 140 
8RP`´Lg ,g - 7TLWLX_g <LaLTg 5YWZ`_H_RYXHTg ?´YJL]]RXPg
 <YHKg JYWZH´R]YXg MY´g _QLg BWH´_g 2X_LXXHg HXKg 88Cg
 4LHWMY´WL´g MY´gK = )(((&g
 Some discussion is needed with respect to the spatial 
steering vector. In the above discussion of a Smart Antenna 
as means of spatial filtering for communications, it has been 
assumed that the AOA to the desired communication signal 
is known to point the beam. This pre-supposes some means 
of spatial detection of the desired signal present in the 
environment. Various Smart Antenna literature use modern 
spectral estimation techniques, as opposed to classic spectral 
estimation based on FFTs, to obtain the AOA estimate. It 
will be assumed here that the AOA is known such that the 
spatial steering vector can be calculated. 
5 
Finally, it should be noted that the transmit path (not shown) 
is implemented independently from the receive path. The 
transmit path is not adaptive and simply consists of a single 
output signal going to M time delay elements similar to that 
in Figure la with the exception that transmit time delay 
elements can be used to combine inputs to a sensor transmit 
element. For the case when an EM plane wave is transmitted 
in the same direction as the receive beam, the time delay 
information can be obtained from the Spatial Steering 
Vector block in Figure lao 
3. A MULTIBEAM DBF STRUCTURE IN FPGAs 
Communications system capacity is an important metric, 
particularly in the aerospace environment where capabilities 
and performance are achieved at a premium cost and the 
mission may be critical. In this section the multi-user 
scenario is considered for the high bandwidth UA V 
communications platform. This requires the capability to 
generate multiple simultaneous transmit and receive beams. 
This section considers a Smart Antenna signal processing 
architecture that supports multi-beam operations to provide 
such a capability. 
From an FPGA implementation perspective, a multibeam 
capability of N dedicated receive beams can be always 
achieved using N dedicated copies of the Smart Antenna in 
Figure lao Using dedicated resources incurs the highest cost 
in terms of FPGA resources and SWaP to implement the 
system. For the Smart Antenna receiver architecture in 
Figure la and a transmit architecture that requires the same 
number of time delay elements, and assuming an RF 
up/down conversion architecture such that one real 
implementation is required at each sensor input and output, 
the number of time delay elements N TD is equal to: 
NTD = MxNBeallls (6) 
where M is the number of sensors in the array and N Beams 
is the total number of dedicated beams for transmit and 
receive. The time delay elements for the receiver would take 
the individual sensor output and implement time delays, one 
delay for each receive beam, on the data producing a single 
data output stream for each delay which would be combined 
with its respective output from the other sensors to 
implement the architecture in Figure lao Implementing the 
transmit side amounts to simply creating a properly time 
delayed input stream, one for each transmit beam, and 
combining them. 
In a multibeam architecture N TD can become large and 
significantly impact FPGA resource requirements and 110 
throughput requirements. FPGA resource sharing can 
provide an alternative to reduce SWaP for multi-beam 
configurations. As an example, consider the time domain 
interpolator described in [7] used to support Advanced 
Multifunction VA V Payloads. The time delay element in [7] 
is based on Lagrange interpolation. Figure 5 shows an 
extended Lagrange Quintic Interpolator (5th order 
polynomial) which supports a four (4) beam receive 
operation at the output of a single sensor at full clock rate 
for the Smart Antenna in Figure lao FPGA resource sharing 
may be applied to this structure. The design space for FPGA 
resource sharing of multibeam time delay elements is 
composed of the polynomial order of the interpolator, sensor 
output sample rate, FPGA clock 
The array sensor output x[n] is split into multiple data 
streams each delayed as required based on the respective 
direction of a given receive beam. Figure 5 shows the 
individual time delays for each of the receive beams with a 
corresponding time delay value f..L and a corresponding 
output y[n]. In other words, each value of f..L corresponds to 
a different receive beam delay value for the sensor output 
x[n]. Output y[n] is multiplied by the beamformer weight for 
the corresponding sensor and receive beam. Modification of 
Figure 5 is relatively simple to expand for a given design 
space. 
JdultJbaa.m. 'I'ttI:Ia Dalay U!inÇ Laq!l.nge Qulntie Intarpclatcr 
x[n] kl 
ul 
u2 
u3 
u4 
1:1= 1/120 
1;:2=- 1/24 
1:3= 1/12 
1'::4=-1/12 
1:::>= 1/24 
1::5=-1/120 
k7 k15 k19 k25 
1---+---tXr-+++--+-...-{;' l-'oH-+-+--:xr-+++--+?x r<t+++-?XJ--+..o+-H--- y 1[n] 
f---t---<o{XT*t+---t-O(}-ooH+-+--ooO(?f-t+--+-D(}á..r++---t..o<:t-to-H7-- y2 [n] 
f---t---<?l-*t+---t-O(J""*f+-+---o(?rt+--+-D<}?7---IÇ:H--H-t- .Y?[ n] 
'---.. xr-r+t---.... ?< }-1oH-t---: X}1of-t+--1o{Xr.f-++-9O{X J--.f-!-t1o- y4[n] 
1.:7=-1/24 1.:13= 1(24- 1:19= 1/24 
k!!= 1/4 k14-=-7/24 1:20=- 1/4-
 k9=-7/12 k15= 11/12 k21= 7/12 
1.:10= 2(3 kHI=-17!12 1'::22=-1/8 
kll=-3/B k:l7= 2%24- k23=-:>/9 
lc12- 1(12 lc18--7 24 1:24- 5/12 
k2?= 1/20 k31= 
k26= 1/3 k32= 
k27= -1 k33= 
1::28= 2 k34= 
11:29=-1%12 k35= 
k30--1 5 ]dia-
 0 
0 
0 
0 
1 
D 
8RP`´Lg-g-=`:_RILHWgCRWLg6LTHdgLTLWLX_g`]RXPg<HP´HXPLg@`RX_RJg;X_L´ZYTH_Y´&g
 speed, the required output sample rate tor YlnJ and the 
number of receive beams. 
6 
Likewise on the transmit side, several communications 
transmitters outputs can be individually time delayed. Each 
output can then be summed to a single output at the correct 
sensor transmit element. Consider a communications 
transmitter output x[n] prior to any beamforming on an 
aerospace platform with a four element array. The structure 
in Figure 5 is then used to support a single beam transmit 
operation. In this transmit operation the corresponding time 
delay values f.1 are calculated such that each output y[n] is 
up of several Smart Antennas, one for each receive beam, 
can utilize transmit and receive AOA information on the 
VA V platform to place corresponding nulls and optimize 
simultaneous TIR performance. Of course FPGA resource 
sharing may be applied to the signal processing performed 
by the SMI algorithm as well as the FFT beamformer in 
Figure lb. 
Multibeam Smart Antenna Example Design 
Steering Vector Bea.m #1 
Steering Vector Bea.m #2 Weights 
Steering Vector Beam #3 
SUM Output 
Multibeam Time Delay #1 
MultibeRIll TiII1.e Delay 
Multibeam Time Delay 
Multibeam Time Delay 
SUM Output 
#2 
Multibeaw Time Delay 
Multibeam Time Delay 
Multibeam Time Delay SUM Output 
Multibeam Time Delay 
#3 
Inverse 
8RP`´Lg .g- =`T_RILHWgBWH´_g2X_LXXHg_Q´LLgJQHXXLTg´LJLRaLgH´JQR_LJ_`´LgMY´gHXgLRPQ_g !0"gLTLWLX_gD<2&g
 applied to a corresponding sensor transmit element across 
the array. The individual outputs y[n] are then sent to their 
respective transmit Digital-to-Analog Converter (DAC) at 
full clock rate. For the multibeam case, several outputs y[n] 
from different interpolators are combined prior to the 
transmit DAC. 
Finally, with regard to the multibeam Smart Antenna it is 
important to note that a multibeam receive architecture made 
7 
4. MULTIBEAM SMART ANTENNA DESIGN 
The Multibeam Smart Antenna can be considered as an 
extension of the Smart Antenna concepts described in 
Section 2 and the Multibeam Time Delay element discussed 
in the previous section. A Multibeam Smart Antenna 
architecture can be modeled using Figure lao From Figure 
la, the CMACC and Matrix Inverse subsystems remain 
unchanged while each multibeam receive channel has 
dedicated complex multipliers and channel sum block to 
form the output of the receiver channel. The output of the 
matrix inversion is presented to the complex multipliers for 
each receive channel. Figure 6 illustrates this receiver 
architecture concept for an eight (8) element ULA. This type 
of multibeam receive architecture is then modeled for 
performance metrics based on the number and AOA of 
interferers, the AOA of the desired signal, the antenna 
beamwidth, covariance matrix update rate, and TIR 
desired signals and interferers under the noise and 
interference operating scenarios. This includes quantifying 
system performance when an interferer and desired signal 
have the same AOA (no spatial diversity). 
As the number of interferers increases, an adaptive array 
requires more degrees of freedom to null them. In a benign 
FFT Based Beamforming Equivalent of Example Design 
Steering Delays 
Steering Delays 
Steering Delays 
Beam #1 
FFT 
SUM 
Output 
FFT #1 
FFT 
Hearn #2 
FFT 
FFT 
SUM 
Output 
#2 
FFT 
FFT 
Beam #3 
FFT SUM Output 
#3 
8RP`´Lg/g- 88Cg4LHWMY´WL´g_Q´LLgJQHXXLTg´LJLRaLgH´JQR_LJ_`´LgMY´gHXgLRPQ_g !0"gLTLWLX_gD<2&g
 architecture. Other system parameters are also included in 
the model, and the collected data for the covariance matrix 
need not consist of only white Gaussian noise. Many 
simulations are performed to verify that the system meets 
performance requirements over the range of AOAs of 
8 
communications environment without external interferers, a 
multibeam system must address interference in a receive 
channel from transmitters (simultaneous transmit) on the 
aerospace platform as well as external transmitters 
communicating with other receive channels in the multibeam 
system (simultaneous receive). For the Multibeam Smart 
Antenna, the RFlMicrowave architecture determines 
whether or not transmit channels and the other receive 
channels are interferers in addition to external interference 
in the environment. Specifically, the TIR isolation, TIR 
frequency allocations, guard band and receiver front end 
filtering will largely determine the impact of these interferes 
to the receive channel. In other words, a system level 
performance budget of the Multibeam Smart Antenna 
accounts for any time diversity, frequency diversity, code 
BRXPTLg4LHWgBWH´_g ?L´JLX_gD_RTRfH_RYXgYMgHg
 2X_LXXHg G5/EG,0-Cg !7]_RWH_L"g
 AGgB`I]d]_LWg <>URJg 4A2=g 6B?,0g
 CMACCs 21.7 < 1 1.7 
Complex Multipliers 10.4 < 1 16 
Complex SUM 3.3 < 1 l.5 
Matrix Inverse 16.8 < 1 11.5 
Time Delay 16.6 < 1 39.2 
Spatial Steering Vector < 1 < 1 < 1 
CY_HTg .1 g * g /( g
 CHITLg )g $ BRXPTLg 4LHWg BWH´_g 2X_LXXHg 8?92g
 ?L´JLX_gD_RTRfH_RYXg7]_RWH_L&g
 BRXPTLg4LHWg88Cg ?L´JLX_gD_RTRfH_RYXgYMgHg
 4LHWMY´WL´g2X_LXXHg G5/EG,0-Cg !7]_RWH_L"g
 AGgB`I]d]_LWg <>URJg 4A2=g 6B?,0g
 FFTs 8.5 3.3 13.2 
Complex Multipliers 5.2 < 1 8 
Complex SUM 3.3 < 1 l.5 
IFFT l.2 < 1 l.7 
Beam Steering Delays < 1 4 < 1 
CY_HTg )0&+g g /&- g *,&-g g
 CHITLg *g $ BRXPTLg 4LHWg 88Cg 4LHWMY´WL´g 8?92g
 ?L´JLX_gD_RTRfH_RYXg7]_RWH_L&g
 diversity and polarization diversity along with the spatial 
diversity provided by the multibeam antenna to assess 
overall communication system performance. If a potential 
interferer has sufficient isolation in one domain then another 
domain may not need to account for it. For example, this 
paper has assumed that sufficient T/R isolation on the 
aerospace platform is present such that the multibeam 
receiver need not consider simultaneous transmitters as 
interferers. 
9 
5. EXAMPLE MULTIBEAM SMART ANTENNA 
DESIGN 
An example design is provided in this section to illustrate 
design concepts and to contrast FPGA implementation 
between the Multibeam Smart Antenna SMI architecture and 
FFT beamformer in Figure 1. 
Consider a Multibeam Smart Antenna made up of an eight 
(8) element ULA with a receive architecture as shown in 
Figure 6. The initial requirements include a Multi-User 
=`:_RILHWgBWH´_g ?L´JLX_gD_RTRfH_RYXgYMgHg
 2X_LXXHg G5/EG,0-Cg !7]_RWH_L"g
 AGgB`I]d]_LWg <>URJg 4A3=g 6B?,0g
 CMACCs 21.7 < 1 1.7 
Complex Multipliers 3l.2 < 1 48 
Complex SUM 9.8 < 1 4.5 
Matrix Inverse 16.8 < 1 11.5 
Multibeam Time Delay 48.8 2.4 93 
Spatial Steering Vector < 1 1.5 < 1 
CY_HTg )*1 g , g ).( g
 CHITLg +g$ =`T_RILHWgBWH´_g2X_LXXHg8?92g?L´JLX_g
 D_RTRfH_RYXg 7]_RWH_Lg MY´g _QLg LcHWZTLg KL]RPXg ZL´g
 8RP`´Lg.&g
 =`:_RILHWg88Cg ?L´JLX_gD_RTRfH_RYXgYMgHg
 4LHWMY´WL´g2X_LXXHg G5/EG,0-Cg !7]_RWH_L"g
 AGgB`I]e]_LWg <>VRJg 4A3=g 6B?,0g
 FFTs 8.5 3.3 13.2 
Complex Multipliers 15.6 < 1 24 
Complex SUM 9.8 < 1 4.5 
IFFT 3.6 1.2 5.1 
Beam Steering Delays < 1 12 < 1 
CY_HTg +/&0 g ).&/g g ,/&*g g
 CHITLg ,g $ =`T_RILHWg 88Cg 4LHWMY´WL´g 8?92g
 ?L´JLX_g D_RTRfH_RYXg 7]_RWH_Lg MY´g _QLg LcHWZTLg KL]RPXg
 ZL´g8RP`´Lg/&g
 system capable of simultaneous high bandwidth 
communications to several Users. An initial system 
requirement includes a 20 MHz channel bandwidth and a 
multibeam capability of three (3) simultaneous transmit 
beams and three (3) simultaneous receive beams. In the high 
dynamics of aerospace communications the update rate for 
the beam weights, t u' is a key performance parameter as 
the Users, interference and UA V platform dynamics 
constantly change the AOAs. Note that arrays are angular 
based tracking systems and that the largest rate of change of 
AOA can be modeled as a function of the flight path and 
distance to the nearest User. For this example, an update rate 
for the beam weight of 10 mSecs will be used for the system 
requirement. 
For this example it is assumed that the only interferers in a 
receive channel are the transmitted signal from the Users on 
the other two channels. Therefore, when all three channels 
are in operation and tracking AOA from three Users, each 
receive channel has a desired signal AOA from a 
corresponding User transmitter as well as two undesired 
interferers with AOAs equal to AOAs for the other two 
channels. 
as well as applying FPGA resource sharing. The SMI 
collection interval time is simply described as: 
K 
te = ----fSAMPUNG 
(7) 
where t e is the time required for collection, K is the 
sample size for the covariance matrix estimate and 
fSAMPLfNG is the sampling rate of the sensors. For the Smart 
Antenna, assuming the Spatial Steering Vector is updated 
without any delay, the update rate for the beam weights is a 
e &@8?6,*9B Smart  :?1::+B2;<B%635B !:06/?5B ( )B ";99@:6.?7;:>B@>6:4B #'$ >B AB ';=-188;B ?IE ? 
RX BEAM #1 
., 
"0 
3 
. , , --------.. --------.. --------.. -------, , , , , , , , , , , , 
.? 0.5 ........ ? ... . . , , ------.. --------.. --------.. -------, , , , 
2 
RX BEA?' #2 
, , , , , , 
1 ¥¥. .¥..¥ ? ..¥...¥. ? .. ..¥. .. ? .¥ ¥..¥¥ :---.¥¥.. ? ¥. .¥¥. . 
., 
"0 
::> 
, ' "  , ' "  , ' "  
} 0.5 áááááááá ráááááá+ááááááá : ááááá áá ráááááááá rááááááá , " , , , , 
90 
? __ ? __ , r ____ ? O ? __ -L __ -=L-__ -L __ ?L-?-L __ ? 
? ? ? ? ? ? 
RX BEA?' #3 
., 
"0 
3 
1 ¥¥..¥... ? ..¥...¥. ? ....¥... ? ...¥..¥¥ ? .¥. , , , , , , 
t 0.5 
........ : .. .. .. .. : .. .. .. .. ( ..... ? ....... 
; 
. .. .. . . 
, " , 
90 
o Auto Track 
o Manual po--
 o Auto Track 
o Auto Track 
o Manual F 
8RP`´Lg0g-=`T_RILHWgBWH´_g2X_LXXHgB_H_`]gHXKg5YX_´YTg9D;gMY´g_QLgLcHWZTLgKL]RPX&g
 For the Smart Antenna implementation using SMI, the 
interval when the sampled data is collected is an important 
initial metric for the update rate of the beamforming weights 
10 
function of length K, the array size (which impacts the size 
of the matrix which must be inverted) and the FPGA 
implementation. When K is relatively small the update rate 
to apply new beam weights is limited by the processing time 
for matrix inversion and applying the beamformer weights. 
In the case for small array sizes where very large values ofK 
are used to obtain better covariance estimates of the 
environment and the FPGA implementation is highly 
parallel, the collection time can be the limiting factor to 
update beam weights. As can be seen from the graphs in 
section 2, the FFT beam former does not incur the same 
increase in processing load. Figure 7 illustrates an 
equivalent FFT Beamformer architecture for the example 
design in this section. The FFT Beamformer in Figure 7 
consists of three dedicated receive channels for an eight 
element ULA and provides a contrasting non-adaptive 
architecture. For a highly parallel processing architecture in 
the FPGA, increases in array size only incur an additional 
FFT per sensor, one additional complex multiply and an 
additional input on the channel sum block. 
For the Multibeam Smart Antenna, the FPGA 
implementation is structured based on subtracting the value 
of tc from tu' This yields the time available to complete 
the matrix inversion and the rest of the processing chain 
after sample data is collected. This time value and the 
processing time (latency) of the FPGA math implementation 
guides the architecture towards highly parallel or sets a 
threshold for FPGA resource sharing. For the FFT 
beamformer in Figure 7, when the FFT sizes remain 
relatively small the dwell time and processing time for the 
FFTs are also relatively small compared to the Multibeam 
Smart Antenna. Using dedicated FFTs at each sensor 
amounts to implementing a fully parallel FPGA 
implementation. When t u is sufficiently long enough, the 
number of FFTs used in the architecture may be reduced by 
resource sharing. 
The design in Figure 6 was completed using a Xilinx Virtex-
 7 XC7VX485T FPGA as the basis for implementation. 
Table 1, Table 2, Table 3 and Table 4 are provided in order 
to contrast the FPGA resources required for implementing 
an eight element ULA for a Single Beam Smart Antenna, 
Single FFT Beamformer, the Multibeam Smart Antenna in 
Figure 6 and the Multibeam FFT Beamformer in Figure 7, 
respectively. FPGA Resource utilization values are 
described based on Logic, Block RAM (BRAM) and DSP48 
usage. Table 1, Table 2, Table 3 and Table 4 provide design 
insight with respect to the implementation cost associated 
with adaptive array signal processing and multibeam 
systems of this type. 
Table 3 represents the FPGA resources required to 
implement the eight element ULA Multibeam Smart 
Antenna for the example design in this section. It is 
important to note in Table 3 that the values exceeding 100% 
assume a second Xilinx Virtex-7 XC7VX485T FPGA is 
available to split the design across two FPGAs. In one 
scenario the Multibeam Time Delay subsystem and CMACC 
11 
subsystem in Figure 6 would occupy the first FPGA, while 
the second FPGA would contain the remaining subsystems. 
The other three architectures can fit into a single FPGA. In 
all four architectures, it is worth noting the cost associated 
with adaptive array processing. 
Figure 8 shows the Multibeam Smart Antenna Status and 
Control GUI for the example design. Note the red trace in 
receive beam #1. The performance of receive beam #1 at 
+45 degrees could be improved by increasing the number of 
sensors, reducing the number of simultaneous receive 
channels or using another domain (code, frequency, etc.) to 
increase isolation. Likewise, performance improvements for 
the other two receive channels can be obtained in the same 
manner. 
6. CONCLUSIONS 
Smart Antennas provide a means for a communications 
receiver to perform spatial filtering and null out unwanted 
signals such as interference in a given direction. In a 
dynamic environment such as a UA V platform this provides 
a valuable capability to reduce interference and maximize 
performance. 
This paper has examined the design and FPGA 
implementation of both Smart Antennas and FFT 
beamformers for high bandwidth UA V communications. 
Specifically, both architectures were examined for single 
beam and multibeam cases and used the delay-and-sum 
beamformer as a basis for a wideband communications 
array. The Smart Antenna architecture in this paper 
implemented the SMI algorithm. Both architectures were 
contrasted to quantify the design complexity and 
implementation cost associated with this type of adaptive 
signal processing versus simple beamsteering using the FFT 
beamformer. This paper assumed digitzing data at the sensor 
level and design data was provided that quantified the 
element level computational processing load for both 
architectures. From this data it can be seen that as the array 
size increases the computational load in terms of complexity 
and required FPGA resources to perform adaptive signal 
processing increases substantially. 
A Multibeam Time Delay element is introduced based on 
Lagrange Interpolation and the work in [7]. Using this 
element, the Multibeam Smart Antenna was considered in 
the paper and reference circuits were provided to clarify the 
design space to apply FPGA resource sharing for time delay 
elements. An example design was provided to illustrate the 
concepts in the paper using a Xilinx Virtex-7 FPGA. 
Finally, it should be noted that although there is additional 
cost and implementation complexity associated with the 
Multibeam Smart Antenna, the significance and value of the 
increased perfonnance and mission capability to aerospace 
platforms often justifies this approach. 
The discussion in this paper has focused on the use of the 
Multibeam Smart Antennas to implement spatial filtering. 
Additional signal processing techniques in other domains 
(code, frequency, etc.) to discriminate Users within the same 
beam can also be applied to this type of architecture to 
improve communication system performance. 
REFERENCES 
[1] Manolakis, D., Ingle, V., Kogon, S., Statistical and 
Adaptive Signal Processing: Spectral Estimation, Signal 
Modeling, Adaptive Filtering and Array Processing, Artech 
House, Norwood, MA, 2005. 
[2] Litva, J., Lo, T., Digital Beamfonning in Wireless 
Communications, Artech House, Norwood, MA, 1996. 
[3] Monzingo, R., Haupt, R., Miller, T., Introduction To 
Adaptive Arrays, SciTech Publishing, 2004. 
[4] Johnson, D., Dudgeon, D., Array Signal Processing: 
Concepts and Techniques, Prentice Hall, Upper Saddle 
River, NJ, 1993. 
[5] Van Veen, B., Buckley, K., Beamforming: A Versatile 
Approach to Spatial Filtering, IEEE ASSP Magazine, April, 
1988. 
[6] Brigham, E., Fast Fourier Transform and Its 
Applications, Prentice Hall, Upper Saddle River, NJ, 1988. 
[7] Porcello, J., Designing and Implementing OFDM 
Communications for Advanced Multifunction VA V Payloads 
using FPGAs, 2012 IEEE Aerospace Conference, March, 
2012. 
[8] Reed, I., Mallett, J., Brennan, L., Rapid Convergence 
Rate in Adaptive Arrays, IEEE Transactions on Aerospace 
and Electronic Systems, AES-IO, no. 6, pp.853-863. 
[9] Compton Jr., R., Adaptive Antennas, Prentice hall, Upper 
Saddle River, NJ, 1988. 
[10] Gross, F., Smart Antennas for Wireless 
Communications with MATLAB, McGraw Hill, Inc. New 
York, 2005. 
[11] Sullivan, M., Practical Array Processing, McGraw 
Hill, Inc. New York, 2009. 
12 
[12] Godara, L., Applications of Antenna Arrays to Mobile 
Communications, Part 1: Performance Improvement, 
Feasibility, and System Considerations, Proceedings of the 
IEEE, Vol. 85, No. 7, pp. 1031-1060, July 1997. 
[13] Godara, L., Applications of Antenna Arrays to Mobile 
Communications, Part II: Beam-Forming and Direction-Of?
 Arrival Considerations, Proceedings of the IEEE, Vol. 85, 
No. 8, pp. 1195-1245, Aug. 1997. 
[14] Godara, L., Smart Antennas, CRC Press, 2004. 
[15] Haykin, S., Litva, J., Sheperd, T., Radar Array 
Processing, Springer-Verlag, New York, 1993. 
[16] Haykin, S., Array Signal Processing, Prentice Hall, 
Upper Saddle River, NJ, 1984. 
[17] Van Trees, H., Optimum Array Processing (Detection, 
Estimation, and Modulation Theory, Part IV), John Wiley & 
Sons, Inc., 2002. 
[18] Sarkar, T., Wicks, M., Salazar-Palma, M., Bonneau, R., 
Smart Antennas, Wiley-IEEE Press, 2003. 
[19] Chandran, S., Advances in Direction-Of-Arrival 
Estimation, Artech House, Norwood, MA, 2008. 
[20] Chen, Z., Gokeda, G., Yu, Y., Introduction to 
Direction-Of-Arrival Estimation, Artech House, Norwood, 
MA, 201O. 
[21] Tuncer, T., Friedlander, B., Classical and Modern 
Direction-Of-Arrival Estimation, Academic Press, 2009. 
[22] Xilinx Web site for Virtex-7 product infonnation 
http://www.xilinx.com/products/virtex7 / 
BIOGRAPHY 
John Porcello is a Senior Research Engineer for the 
Georgia Tech Research Institute (GTRl). Mr. Porcello 
designs, develops and implements Digital Signal Processing 
(DSP) Algorithms in FPGAs for a wide range of 
applications including communications and radar, and is a 
Senior Member of the IEEE (porcello@ieee.org). 
