Non-linear Preprocessing of Heavy Tailed Reverberation 
D.W. Ricker, A.J. Cutezo 
Applied Research Laboratory 
Pennsylvania State University 
PO Box 30 State College, PA 16804 
dwrl @psu.edu 
ph: 814-863-0313. fax: 814-863-7841 
Abstract-Echolocation in shallow water is often character- 
ized by high spurious detection rates generated by heavy 
tailed (impulse like) boundary reverberation. While persis- 
tent echos that are delayDoppler consistent over several in- 
terrogations are best detected and left to a subsequent clas- 
sifier stage, impulsive transient events in the time series can 
be suppressed by preprocessing the data stream with a non- 
linear filter. A simple preprocessor consisting of a linear pre- 
dictor with a thresholded non-linearity has been used to at- 
tenuate sporadic impulse like events and successfully reduce 
the heavy pdf tails of synthesized Rayleigh mixture reverber- 
ation matched to actual data. It is shown that the preproces- 
sor was able to restore nearly all of the ROC performance of 
a matched filter and reduce the false alarm yet maintain the 
detection rate when applied to real data from a shallow water 
rocky bottom area.’ 
1. 
2. 
3. 
4. 
5 .  
6. 
7. 
TABLE OF CONTENTS 
INTRODUCTION 
THE ROBUST WHITENER 
THE DATA SWITCH 
A RAYLEIGH MIXTURE REVERBERATION MODEL 
EXPERIMENTAL RESULTS WITH SYNTHESIZED DATA 
PREPROCESSING OF IN-WATER DATA 
CONCLUSION 
1. INTRODUCTION 
Classical maximum likelihood processors based upon a 
Gaussian assumption such as matched filters are termed op- 
timum or parametric processors because they are designed 
from assumed knowledge of the underlying statistics. In ad- 
verse sonar environments as when operating in shallow wa- 
ter, near rough boundaries (under ice), or in the presence 
‘0-7803-6599-2/01/$10.00@IEEE 
of impulsive ambient noise, reverberation tends to be non- 
stationary often changing from Gaussian volume backscatter 
to boundary backscatter that may be more impulsive. When 
this occurs, a Gaussian based (matched filter) detector usu- 
ally experiences a much higher false detection rate because 
the underlying statistics are heavy tailed. Evidence of this is 
found in bottom scattering measurements reported by Jack- 
son et al [ l]  
Spurious detections fall into two categories, false echos; 
implying that there is an actual object causing the echo, and 
statistical false alarms that occur randomly due to reverber- 
ation and ambient noise. In deep water or when the bound- 
ary conditions are uniform, reverberation tends to follow a 
Gaussian model, conventional processor performance can be 
predicted, and the desired thresholds can be set to achieve 
a specified pf . When operating in shallow water with nu- 
merous boundary interactions (multipath) and the boundaries 
have patches of differing backscatter strength, the false alarm 
statistics become heavy tailed causing higher false alarm rates 
than would be predicted by the Gaussian model [2,3].  
False (and desired) echos tend to persist over several in- 
terrogations and should not be rejected by the detector but 
passed on for examination by a post detection classifier stage. 
Since it is desired that all legitimate detections be examined it 
is advantageous to adjust the detector threshold adaptively so 
that its throughput matches the capacity of the downstream 
processing. If there are too many statistical events (false 
alarms) the effective throughput for legitimate detections is 
reduced because the adaptive threshold will attempt to main- 
tain a constant “hit rate”. It would then be advantageous to 
preprocess the data stream to eliminate as many of the statis- 
tical events as possible before entering the detector. 
Detector design for non-Gaussian interference comes un- 
der the general heading of non-parametric and robust process- 
ing. A considerable literature exists on the subject and [4] is 
an excellent review for the interested reader. Robust process- 
ing is often simply approached by suppressing impulses with 
soft or hard limiters, passing the clipped data through a lin- 
ear filter, and finally testing with a threshold. In cases where 
the test statistic is also heavy tailed, the threshold may be de- 
4-1797 
termined using rank ordering to reduce the effects of outliers 
[6]. This approach while effective can be computationally ex- 
pensive. Hard clipping of the raw time series can be used to 
detect known constant signals in impulsive noise [4]. This 
approach is perhaps a bit heavy handed if the data is contami- 
nated by heavy tailed interference only a small portion of the 
time and for the most part can be processed by conventional 
detection algorithms. This sporadic contamination of a nom- 
inal process can be modeled as E contamination [5] and has 
been found to be a useful approach for the generation of pdf 
mixtures for the synthesis of bottom reverberation [3]. 
A legitimate echo generated by interrogation with a wave- 
form of duration T will not be substantially affected by a filter 
that suppresses impulsive events in the input time series that 
are short in relation to T. Moreover, weak (low' SIR) echos 
that are detectable by a matched filter are often not observ- 
able in the time series envelope and would tend not be sup- 
pressed as an impulsive event. This suggests that a detection 
strategy based upon the suppression of occasional outliers or 
impulsive: events in the time series would be applicable to the 
detection of echos in boundary reverberation. 
2. THE ROBUST WHITENER 
An intuitively pleasing and computationally simple ap- 
proach to impulse suppression has been suggested by Effron 
and Jeen [6] .  It is a linear predictor that contains a nonlin- 
earity to suppress occasional impulses in the sampled time 
series. When the innovations sequence representing the error 
ek between the predicted and actual value of a data sample 
exceeds a specified value, it is suppressed in proportion to the 
amount that it exceeds the threshold minimizing the effect of 
the transient on the predictor loop. This robust whitener is 
followed by a data switch that selects between the raw data 
samples ,and the predicted values. Normally it feeds the in- 
put data stream directly to the output but when an impulse 
is detected, the switch selects the predicted value from the 
whitener loop. Instead of merely clipping an anomalous sam- 
ple, this arrangement replaces it with the estimated sample 
generated by the whitening filter. 
The simple single pole IIR filter shown in Figure l a  will 
be used to illustrate the preprocessor although more complex 
structures can be constructed. The random input and pre- 
dicted data sequences are denoted by rk and i k  and the non- 
linearity shown in Figure l b  is defined by 
where ek = rk 7 f k  is the error sequence. The threshold y 
is set at a sufficiently high level so that under nominal condi- 
tions the filter will operate linearly. A threshold of y = 30 is 
suggested [6]. The nonlinear suppression function in the tails 
of the nonlinearity is not critical as long as it is monotonically 
decreasing. A Gaussian tail is suggested by the authors but 
the hyperbolic function used in (1) is simpler to implement 
and analyze. The filter is described by the recursion relations 
la .  Predictor Loop 
I i* 
I 
l b .  Hyperbolic Nonlinearity 
Figure 1. The nonlinear predictor 
with0 5 a < 1 
that are equivalent as long as the error i s  in the linear region 
lek I < y. There, the transfer function is 
1-a! H ( z )  = 
z - a !  ( 3 )  
and it will respond to an deterministic impulse TO + A from 
a steady :state condition of input r g  at time k as 
Likewise the response to a step input TO + A at time k is 
L 
x To + (1 - (1 - Ql>an> A .  
The stealdy state frequency response in the linear region is 
obtained by setting z = exp j w T ,  in (3)  where w is the radian 
frequency and T, is the sampling interval. The magnitude 
square tr:ansfer function is 
and by specifying a desired cutoff frequency w, and attenua- 
tion A < 1, a is computed from 
1 - A COS w,T, 
1 - A  
f f =  
When the error exceeds the threshold, entirely different 
things happen and the response depends upon which of the 
4-1798 
relationships in (2)  are used to implement the filter. This 
is demonstrated by computing the deterministic transient re- 
sponse when I A I > y at step k for implementations (2b) 
and (2c). The magnitude of the error between the actual input 
and the predicted input at step k + n for the impulse A is 
I = I?k+n - T O  I and the errors corresponding to (2) are 
Jek+nl  = an-' (1 - a)[  A I linear filter (2a), 
= (1 - a )  (I?) Y21 A I (n = 1) 
A I  
=an-'(l - a)  (w) (n > 1) (2b) 
A I  
The greatest error always occurs at the first update after the 
transient and since it is assumed that y2 / I  A I < 1 , the small- 
est initial error occurs for implementation (2b) followed in 
order by the linear filter (2a) and implementation (2c). Fil- 
ter (2b) reverts to the linear form after the first update and 
the error decays exponentially. This means that it is the most 
accurate predictor in the presence of an impulsive transient. 
3. THE DATA SWITCH 
The nonlinear filter operates in parallel with a data switch 
that is triggered by the same impulses in the error time series 
that cause the filter to go nonlinear. The switch produces the 
output 
r k ,  i f ( % (  2 y 
in effect selecting the raw input data samples until an impulse 
is detected and then switching to the sample value predicted 
by the nonlinear filter. 
Jackson's Faimouth Site 1 
0 
-0.5 
-1 
2 -1.5 
2 
!2 
2 -2 
I g -2.5 
0 
E -3 
4 
-3.5 
4 
AmpfiMe/Mean 
Figure 2. Rayleigh mixture probabilities 
4. A RAYLEIGH MIXTURE REVERBERATION 
MODEL 
Examination of boundary reverberation field data led Mc- 
Cammon et a1 [3] to suggest a Rayleigh mixture model that 
could be parametrically fitted to observed data. Their model 
is the E mixture of two Rayleigh pdfs expressed in terms of 
their individual means p = crm 
f m i z ( X )  = (1 - E ) f l ( X )  + E f 2 ( X )  
+ E (31 
The mixture mean is p m  = (1 - + ~ p 2 .  By defining the 
parameters y = p ~ / p 1 ,  a = (1 - E )  + €7, and the mixture 
normalized random variable z = x / a p m ,  the mixture pdf 
obtained from 
is 
(4) 
This model was compared to in-water reverberation data 
reported in [ I ]  where the empirical relationship 
6 = exp -(1.4352(y - 1)) 
and the mixture mean ratios y=1.57(3.9 dB),1.94(5.8 dB) 
were used to bracket the measured envelope p@s as shown 
here in Figure 2 which is a reproduction of Figure 12 of [3]. 
5. EXPERIMENTAL RESULTS WITH 
SYNTHESIZED ATA 
In order to test the nonlinear prefilter against the mix- 
ture model it was necessary to synthesize realizations of data 
drawn from the mixture pdf. To generate the random mix- 
tures, the Sonar Simulation Toolkit (SST) [7] was used to 
generate three independent Gaussian reverberation time se- 
ries with relative standard deviations of cr = 1.0, 1.57, 1.94. 
The magnitudes were computed to form Rayleigh samples 
and in order to be consistent with the experimental data re- 
ported in [ 13, the time series were each detrended by an AGC 
loop prior to forming the mixture. 100 pings of reverberation 
using an 80 msec.-1600 Hz. bandwidth LFM waveform were 
generated and sampled at 2646 Hz. Each time series was 3.08 
sec. in duration so that there were 38500 independent realiza- 
tions from which to generate the pf histograms. 
The mixtures for y = 1.57 and 1.94 were formed according 
to (4) from the individual Rayleigh realizations correspond- 
ing to 0 =( 1,1.57) and (1 , 1.94) respectively. The realizations 
were thresholded and the frequency of threshold crossings are 
plotted as curves (1,2) in Figure 3 where the abscissa is the 
threshold normalized by the sample mean and the ordinant is 
the fractional number of crossings or false alarm probability 
expressed in dB. These plots compare favorably with those 
4-1799 
derived by McCammon et a1 shown in Figure 2 and in each 
case, the heavier tails of the mixtures and real data are appar- 
ent when compared with the Rayleigh pf which is curve (6). 
The mixtures were passed through the nonlinear preprocessor 
of Fig. 1 and the results plotted as curves (3-5) in Figure 3. 
Preprocessing clearly offers some benefit for the reduction of 
the probability of a threshold crossing. Tightening the thresh- 
old to 20 appears to give better results than 30. 
The performance of an LFM matched filter operating in 
the reverberation mixtures was assessed by synthesizing a 
point scatterer embedded in the reverberation at an input SIR 
of -5 dB. This generated input time series realizations that 
were correlated with the LFM replica. The resulting empiri- 
cal ROC curves (histograms) of p d  vs pf are shown in Fig. 4 
and indicate severely degraded detector performance for the 
unprocessed mixtures (curves 5,6) in comparison to the the- 
oretical and SST derived Gaussian (Rayleigh) (curves 1,2). 
The preprocessor restored much of the ROC performance as 
indicated by curves (3,4). 
Figure 3. Filtered mixture distributions 
I " " " " '  I 
5// 
1: Theorrtid. Gaussian d. 
2 Synth. SST. Gaussian reverb. 
3: P-c. echo in rewrb. mix. (7 4.57.  thM=ZU) 
41 Prepac. echo in mmb. mix. (7 =1.94. thM=3~) 
5: Echo in reverb. mix. (7 =1.57) 
6 Echo in reverb. mix. (7 d.94) 
Figure 4. LFM matched filter ROC curves 
6. PREPROCESSING OF IN-WATER DATA 
In 1995 a series of field experiments were made at a shal- 
low water site characterized by severely downward refracting 
a. MF Detections 
hits: [N,.=l$, Np=18, Nf,=19] - 
L ?'false alarms 18, p - 0 
1 000 2000 3000 
RANGE (YARDS) 
0 
4-1 8130 
(FOM=l)  
Figure 5. Unfiltered in wateir detections 
raypaths and a rocky bottom, ideal conditions for heavy tailed 
reverberation. Among the experiments was the 15 ping LFM 
interrogation and matched filter detection of an artificial echo 
repeater in a geometry known to produce a high number of 
both persistent and random false detections. 
The criterion for detector comparisoin was based upon the 
number of known repeater echos N,, persistent false echos 
N f e ,  and false alarms N f a  detected. These numbers are 
somewhat subjective as they derive from visual interpretation 
of the track records that are plots of threshold crossings (hits) 
vs ping number shown in Figure 5. The position of the re- 
peater was known so Nr could be easily ascertained. N f e  
was deteimined by the number of hits that fell on a consistent 
track and the remainder were designated as false alarms N f a .  
An adaptive matched filter thresholding scheme was used 
to maintain the hit rate to a prescribed number of hits per unit 
search range and the figure of merit (FOM) 
was devised to penalize a detector for false alarms and echos 
but awarded it for repeater detections. The constants c1, c2 
weight the relative severity of the false detections. 
The experiment was performed in two legs so that there 
is no data between pings 26 and 39. .All hits are indicated 
by stars and the repeater track and those of the persistent 
detections are evident by the well defined strings of detec- 
tions at decreasing range with ping nuimber. The known re- 
peater positions are indicated by the crossed circles and a de- 
sired detection was declared when the indicated detection and 
known position were within a specified range interval. Ver- 
tical false detection tracks that appear at constant range are 
called "push broom"tracks and are caused by downward re- 
fracting iray paths that intersect the bottom at a constant range. 
The benefit of non-linear preprocessing is evident from a 
60 
50. e *  ”&., oo* 
(FOMd.53) 
40. te 
230. 
n 
% e 8 8  
2 0 .  % e * * *  0 
_ _  
0 o mo 0 
0 [7.] Goddard, R.P., “Sonar Simulation Toolset Software Web 
Release 3.3.5,”, APL-UW TM 10-96, (Revised March 
1999), Applied Physics Lab. Univ. Washington 
1 000 2000 3000 
RANGE (YARDS) 
ation from the Sea Bed,” ARL TM 98-046, Applied Re- 
search Lab. State College, PA May 15, 1998. 
[4.] Kassam, S.A., H.V. Poor “Robust Techniques for Signal 
Processing, A Survey,” Proc. IEEE 73(3) 3/85, pp433- 
81. 
[5.] Huber, P.J., “A Robust Version of the Probability Ratio 
Test,” Ann. Math. Stat., Vol36, Dec. 1965, pp 1753-58. 
[6.] Efron, A.J., H. Jeen, “Detection in Impulsive Noise 
Figure 6. Filtered in water detections 
10- 
ACKNOWLEDGMENT 
Based on Robust Whitening,” IEEE Trans. on Signal 
Proc. 42(6) June 1994 pp 1572-76. 4 
comparison of the detector outputs shown in Figures 5 (no 
preprocessing) and 6 (with preprocessing) and the relative 
numbers of hits of each category. The filter was implemented 
as shown in Figure 1 and equation (2b) with threshold 2u 
of the sample data variance and feedback constant a = .75. 
These parameters are not claimed to be optimum but through 
preprocessing, all of the desired echos and one extra false 
echo were detected and seven false alarms were eliminated. 
The FOM which was weighted to penalize false alarms 5 
times as severely as false echos was increased by 53%. 
This work was supported by the Office of Naval Research. 
7. CONCLUSION 
Nonlinear preprocessing benefits matched filtering when 
the data is subject to heavy tailed amplitude events in the time 
series. Preprocessing cannot remove coherent artifacts related 
to specular components of the underlying spreading function 
that may be legitimate echos if these do not affect the input 
time series envelope sufficiently to cross the filter threshold. 
This is not necessarily bad as these “embedded coherences” 
are subject to detection and must be subject to downstream 
processing to identify desired echos. The benefit of prepro- 
cessing is the elimination of some of the heavy tailed random 
events that reduce processor throughput thus permitting the 
examination of more of the potentially legitimate echos. 
8. REFERENCES 
[l.] Jackson, D.R., A.M. Baird, P.A.G. Thompson, “Second 
report on TTCP bottom scattering measurements: Data 
summary,” Admiralty Research Est. Portland UK, report 
#71807 May 1985. 
12.1 Sheckler, L.S., “Investigation of Mechanisms that Cause 
Changes to Bottom Reverberation Fluctuation Statis- 
tics,” ARL TR 98-001 (PhD Thesis in Acoustics), Jan, 
1998. 
Dennis W. Ricker (S159-M’61-SM’81) received the B.E.E. 
degree from Union College, Schenectady N.Y in 1961, the 
M.S.E.E. from the Pennsylvania State University, University 
Park, in 1963, and the PhD in electrical engineering from 
Purdue University, Lafayette, IN. in 1969. He has been with 
the Applied Research Laboratory of the Pennsylvania State 
University since 1969 and currently holds the dual titles of 
Senior Scientist and Professor of Acoustics. He has con- 
ducted research on active sonar echolocation with empha- 
sis on detection and estimation, high resolution sonar imag- 
ing, scattering functions, waveform design, and wideband 
4-1801 
(wavelet) processing of sonar signals. His most recent work 
has been on techniques for echo detection and classiJication 
of sonar echos in spread channels. Dc Ricker has published 
in IEEE :lransactions, JASA, and JUA on various aspects of 
signal processing and echo location and holds two patents 
in the signal processing area . His avocational interests in- 
clude pe?fofomzing old time string band and bluegrass music 
and restoring antique cars. 
Anthony J. Cutezo received the B.S.E.E. degree f ivm The 
Pennsylvunia State University in August 1975. Since 1985 he 
has been with the Applied Research Laboratory, The Penn- 
sylvania State University, where he is currently an Associate 
Research Engineer engaged in signal processing research. 
He received the M.S.E.E. degree from The Pennsylvania State 
Universig in August 1990. His interests include statistical 
detection and parameter estimation. 
, 
4-1802 
