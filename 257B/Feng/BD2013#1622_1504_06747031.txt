                                 978-1-4799-2761-6/13/$31.00 ©2013 IEEE                                 712
 2013 6th International Conference on Biomedical Engineering and Informatics (BMEI 2013)                       
Building Localized Bioinformatics Platform Based on 
Galaxy and High Performance Computing Cluster 
 
Xiao-lei Wang, Jiang-yu Li, Yang Liu, Yu-feng Wang, Dong-sheng Zhao 
Institute of Health Service and Medical Information 
Academy of Military Medical Sciences 
Beijing, China 
 
Abstract—With the rapid development of high-throughput 
sequencing technology, biomedical research has entered into the 
era of big data. It causes problems about storage and analysis of 
massive biological data which need to be solved by high-
 performance computing. Therefore, we build the localized high-
 performance one-stop data analysis platform to provide 
convenient and efficient computational analysis services for 
biomedical researchers. We deploy Galaxy and integrate 
software tools and datasets into Galaxy in computing cluster, 
build stable web service, FTP service and management database 
in order to optimize and improve the performance of Galaxy, and 
use distributed resource management application interface to 
collaborate Galaxy with Sun Grid Engine for automatically 
scheduling and assigning computing resources. Currently the 
platform has been put into trial operation. The peak performance 
is 10 Teraflops and the capacity of storage is 40TB. The platform 
provides many functions such as sequence alignment, short 
sequence mapping, gene annotation, transcriptome analysis, 
metagenomic analysis and phylogenetic analysis, and 
approximately 700GB reference databases including human 
genome, viruses, bacteria, fungi, etc.. 
Keywords-Localized; Bioinformatics; Galaxy; Online analysis; 
High-performance Computing 
Along with the development of high-throughput sequencing 
and other genomics technologies, the need of biomedical 
research of data processing and analysis becomes more and 
more urgently. The rise of new areas of research and methods, 
such as metagenomics [1], genome-wide association analysis 
(GWAS), RNA-Seq and so on, gives birth to a large number of 
new bioinformatics software and analysis flow. Efficiently 
organizing decentralized software, building a unified database, 
providing a convenient and easy-to-use user interface, and 
using high performance computing to handle large-scale data 
and providing a one-stop local computing services, will greatly 
accelerate the data analysis process to promote the 
development of the biomedical research. 
Web technology is an important means of integration for 
bioinformatics software. There are many successful systems 
such as EMBOSS, Galaxy [2], NCBI and UCSC, etc.. Public 
service platform on the internet is generally provided by large 
research institutions. Their computing and storage resources for 
external users are too limited to meet the demand of large data 
analysis. For data security, users are usually reluctant to submit 
sensitive data to public platform. At the same time, the core 
data of many public platforms is not open to external users. 
Therefore, to establish localized, high-performance data 
analysis platform, not only can greatly enhance the core 
technical capabilities for related research, but also effectively 
prevent the leakage of sensitive data. This paper describes how 
to build a bioinformatics platform which can simultaneously 
run multiple data analysis jobs, and provide commonly used 
bioinformatics analysis flow and database services by 
combining Galaxy with high-performance cluster. 
I. RESULTS 
We have achieved the core functions of the local high-
 performance bioinformatics analysis platform using the 
computing resources in Network Information Center of the 
Academy of Military Medical Sciences. We have integrated 
commonly used software and database resources in the 
platform. And with the help of powerful high-performance 
cluster, the platform provides functions such as sequence 
alignment, short string mapping, gene annotation, 
transcriptome analysis, metagenomic analysis and phylogenetic 
analysis for users. 
A. Integrated Tools 
Through the questionnaire survey to some experts of the 
related research field, the most commonly used and the most 
urgent needs of bioinformatics software for military medical 
research and major diseases prevention and control tasks are 
identified. These software tools are integrated into the 
platform, and used according to the function classification for 
online analysis. See table 1. 
 
 
 
 
                                                                                                                                          713
 TABLE I.  THE INSTALLED TOOLS LIST 
Name Description 
BLAST [3] An algorithm for comparing primary biological sequence information, such as the amino-acid sequences of different proteins or the nucleotides of DNA sequences 
BLAT [4] An alignment tool like BLAST, more accurate and faster than popular existing tools for mRNA/DNA and protein alignments 
Bowtie [5] 
Bowtie2 An ultrafast, memory-efficient short read aligner 
BWA A software package for mapping low-divergent sequences against a large reference genome 
ClustalW A widely used multiple sequence alignment tool 
Cufflinks [6] A tools can assembles transcripts, estimates their abundances, and tests for differential expression and regulation in RNA-Seq samples 
EMBOSS A free open source software analysis package specially developed for the needs of the molecular biology and bioinformatics user community 
FreeBayes A high-performance, flexible, and open-source Bayesian genetic variant detector 
MACS [7] A program for model-based analysis for ChIP-Seq 
MrBayes [8] A free software program which performs Bayesian inference of phylogeny 
RepeatMasker  A program that screens DNA sequences for interspersed repeats and low complexity DNA sequences 
Tophat [9] A fast splice junction mapper for RNA-Seq reads 
 
B.  Integrated Database Resources 
According to the reference database demands from experts, 
a large number of datasets from international biomedical 
database website, such as UCSC, NCBI, etc. have been 
downloaded [10][11]. Format conversion and index 
optimization are executed for those datasets, and updated 
regularly. The local platform integrates up to 700GB of 
datasets, including: human genome, virus database, bacteria 
database, fungi database, UCSC human database, ENSEMBL 
human and mouse database, and Refseq human reference 
database, etc.. See table 2. 
TABLE II.  THE INTEGRATED DATASETS LIST 
Database Name Database sources Database Usage Size 
Human Genome, RNA 
Database and Annotation 
UCSC Location and Annotation of High-throughput Sequencing Data 32GB 
Greengenes Database NCBI,RDP Assist to select phylogenetic specific probes, interpret  microarray results, align/annotate new sequences 8.1GB 
LSU, SSU Database ENA/EB,SILVA,LPSN Small subunit rRNA (SSU) and large subunit rRNA (LSU) alignment analysis of bacteria, archaea and eukaryotes 10.4GB 
M5NR Database GO,Greengenes,NCBI Metagenomic annotation and comparative analysis of prokaryotes 77.4GB 
TrEMBL Database EMBL?GenBank?DDBJ?PDB Non-redundant protein sequence data with high-quality and non-automatic annotation 29.2GB 
IMG Database RefSeq Bacteria, archaea, eukaryotes, virus genome alignment analysis 24.1GB 
SEED Database Genbank Bacteria, archaea genome annotation 10.3GB 
PATRIC Database  GenBank The bacterial phylogenetic data annotation, comparative analysis and visualization 52GB 
Human, Mouse Database ensembl Human and mouse genome database 5.26GB 
RefSeq Database NCBI 
Functional annotation, a stable reference point mutation analysis, 
gene expression studies, and polymorphism discovery of the 
human genome 
10.4GB 
Bacteria, fungi, human, human 
microbiome and virus database NCBI Complete genome data 149GB 
Human, RefSeq, etc. Database 
in BLAST Format NCBI BLAST alignment database in FASTA format 77.7GB 
 
C. Web Server 
The platform uses web technologies to provide services for 
users. Registered users can use all functions of the platform, 
including data upload, datasets query and browsing, online data 
analysis. In addition, for the data analysis processes may be 
repeated, the platform provides a workflow mechanism. Users 
can flexibly organize tools and datasets, create and save a 
workflow which can be invoked directly for the same data 
analysis. Fig. 1 is a CHIP-Seq analysis process. 
                                                                                                                                          714
  
Figure 1.  The Example of CHIP-Seq Workflow
 D. High-performance Computing Resources 
The high-performance computing cluster of the Platform is 
the Lenovo Deepcomp 7000, including one management node, 
26 compute nodes (including two high-performance GPU 
nodes), and the capacity of storage arrays is 40TB. The 
computing network is 40G high-speed infiniband network, the 
peak performance is 10 Teraflops and the capacity of storage is 
40TB. The data analysis requests submitted by users will be 
converted into the background computing tasks. The platform 
uses powerful computing resources for large-scale data 
processing to deal with the tasks. 
II. DESIGN AND IMPLEMENTATION 
A. Module Design 
The platform consists of six modules. The relationship of 
the various modules is shown in Fig. 2. 
• Web service module. This module implements user 
registration and certification, FTP data upload, and 
unified web view. In addition, the module also 
implements another functions with MySQL database, 
such as user authority management and role definition. 
• Cluster management module. This module monitors 
the status of the cluster, manages tasks and queues, and 
schedules resources. 
• Tools management module. This module is used to 
integrate, manage and configure bioinformatics 
software tools.  
• Dataset storage module. This module downloads 
databases from NCBI, UCSC and many others 
websites. In addition, the module saves, updates, and 
uses these databases to supply data navigation and 
inquiry service. 
• Dataset format convert module. This module converts 
data format according to different application 
requirements. 
• Data analysis module. This module enables users to 
analyze data online, or organize various tools and 
databases flexibly to create workflow. And then the 
module transforms requests of users for data analysis 
into computing tasks and submits to the cluster. 
                                                                                                                                          715
  
Figure 2.   Module Interaction 
 
B. Technology And Implementation 
• Build cluster computing environment. We Installed 
and configured Rocks, Ganglia and other management 
software in the cluster to achieve rapid cluster 
configuration, status monitoring and other functions. 
The cluster uses Sun Grid Engine to establish the 
distributed computing infrastructure, schedule 
resources, manage tasks and queues. 
• Deploy localized galaxy. Galaxy is an open, web-based 
and world famous platform for data intensive 
biomedical research. It has a wide range of 
applications throughout North America and around the 
world, powerful and supports costumed development 
[12][13]. We deploy the Galaxy in the local high-
 performance cluster for large-scale data processing, 
and use Distributed Resource Management Application 
API(DRMAA) to cooperate with Galaxy. The data 
analysis tasks submitted to Galaxy through DRMAA 
will invoke Sun Grid Engine to generate the PBS 
scripts running in the background. Sun Grid Engine 
scheduler can automatically allocate hardware 
resources according to the load of the compute nodes. 
• Build web and FTP services. We use Apache to build 
secure and reliable web services, such as user 
authentication, caching, data compression and small-
 scale data upload. Using the web server to upload 
large-scale data will degrade the performance of the 
web server. So we use ProFTPD to upload large data. 
The data uploaded by users will be kept for a short 
period, and will be used to analyze by the platform 
directly. 
• Build data analysis service. Data analysis service is 
based on the Galaxy framework for customization and 
integration. The Galaxy framework provides unified 
web interface for tools and datasets. Users can submit 
and perform data analysis requests through Galaxy. 
• Integrate tools and datasets. This service is able to 
download, compile, install and configure commonly 
used bioinformatics tools, format and index the 
datasets, and then integrate tools and formatted 
datasets into Galaxy in accordance with the 
organizational form provided by Galaxy. Users will be 
able to select the desired software tools and datasets to 
configure parameters and submit the data analysis 
requests through a browser. In addition, users can 
create inquiry, download and invoke reusable data 
analysis workflows by the installed software tools and 
datasets. 
• Build data management and download service. We use 
a script program to download and update reference 
genome databases from NCBI, UCSC and other 
international web sites. 
• Configure management database. We replaced the 
lightweight single-user database in Galaxy with 
professional relational database MySQL to enhance 
multi-user concurrent processing capability and 
scalability. The database is used to manage all user 
information, dataset information and workflow 
information. 
                                                                                                                                          716
 Figure 3.  The Technology Roadmap of The Platform 
III. DISCUSSION 
The platform has been put into trial operation, and 
registered users can upload data to be analyzed, submit data 
analysis tasks, apply computing resources, create and use 
workflow. The software and data resources within the platform 
have begun to take shape. 
We will continue to improve the function of the platform 
such as adding bioinformatics tools and datasets constantly, 
automatically downloading and updating data from NCBI and 
other sites. In order to achieve the rapid identification of 
important pathogenic microorganisms based on metagenomic 
sequencing analysis, we will parallel and optimize some well-
 known workflow such as Pathseq [14], Rins and so on. At the 
same time, we will study how to combine Galaxy with large 
data processing framework such as Hadoop [15], enable users 
not only submit the traditional PBS parallel computing tasks, 
but also run Hadoop-based biomedical analysis tasks. 
REFERENCES 
[1] V. Kunin, A. Copeland, A. Lapidus, K. Mavromatis and P. Hugenholtz, 
“A bioinformatician’s guide to metagenomics,” Microbiol. Mol. Biol. 
Rev.,  vol. 72, pp. 557, April 2008. 
[2] D. Blankenberg, G. V. Kuster, N. Coraor, G. Ananda, R. Lazarus, M. 
Mangan, A. Nekrutenko, J. Taylor, “Galaxy: a web-based genome 
analysis tool for experimentalists,” Curr Protoc Mol Biol, vol. 19, pp. 1-
 21, January 2010. 
[3] S. F. Altschul, W. Gish, W. Miller, E. W. Myers, and D. J. Lipman,  
“Basic local alignment search tool,” J. Mol.Biol., vol. 215, pp. 403–410, 
October 1990. 
[4] W. J. Kent, “BLAT-the BLAST-like alignment tool,” Genome Res., vol. 
12, pp.  656-664, March 2002. 
[5] B. Langmead, C. Trapnell, M. Pop and S. L. Salzberg, “Ultrafast and 
memory-efficient alignment of short DNA sequences to the human 
genome,” Genome Biology, vol. 10, pp. R25, March 2009. 
 
[6] C. Trapnell, B. A. Williams, G. Pertea, A. Mortazavi, G. Kwan, M. J. 
Baren, S. L. Salzberg, B. J. Wold and L. Pachter, “Transcript assembly 
and quantification by RNA-seq reveals unannotated transcripts and 
isoform switching during cell differentiation,” Nat. Biotechnol., vol 28, 
pp. 511–515, February 2010. 
[7] Y. Zhang, T. Liu, C. A. Meyer, J. Eeckhoute, D. S. Johnson, B. E 
Bernstein, C. Nusbaum, R. M. Myers, M. Brown, W. Li and X. S. Liu, 
“Model-based analysis of ChIP-Seq (MACS),” Genome Biology, vol. 9, 
pp. R137,  September 2008. 
[8] J. P. Huelsenbeck and F. Ronquist, “MRBAYES: bayesian inference of 
phylogenetic trees,” BIOINFORMATICS APPLICATIONS NOTE, vol. 
17, pp.  754-755, January 2001. 
[9] C. Trapnell, L. Pachter, and S. L. Salzberg, “TopHat: discovering splice 
junctions with RNA-seq,” Bioinformatics, vol.  25, pp. 1105–1111, 
February 2009. 
[10] Y. Q. Mao, J. Y. Li, X. L. Wang, D. S. Zhao, “Construction and 
application of mirror FTP server of NCBI database,” Bull Acad Mil Med 
Sci, vol. 34, pp. 272-274, Jun  2010. 
[11] Y. Q. Mao, J. Y. Li, X. L. Wang, D. S. Zhao, “Consturction of local SRS 
service system based on EBI database,” China Journal of  
Bioinformatics, vol. 9, pp. 93-96, Jun 2011. 
[12] J. Goecks, A. Nekrutenko, J. Taylor, “Galaxy: a comprehensive 
approach for supporting accessible, reproducible, and transparent, 
computational research in the life sciences,” Genome Biology, vol. 11, 
pp. R86, August 2010. 
[13] J. Taylor, I. Schenck, D. Blankenberg, A. Nekrutenko, “Using galaxy to 
perform large-scale interactive data analyses,” Curr Protoc 
Bioinformatics, vol. 10, pp. 10.5.1-10.5.25, September 2007. 
[14] A. D. Kostic, A. I. Ojesina, C. S. Pedamallu, J. Jung, R. G. W. Verhaak, 
G. Getz, M. Meyerson, “PathSeq: software to identify or discover 
microbes by deep sequencing of human tissue,” Nature Biotechnology, 
vol. 29, pp. 393-396, May 2011.  
[15] A. McKenna, M. Hanna, E. Banks, et al, “The genome analysis toolkit: a 
MapReduce framework for analyzing next-generation DNA sequencing 
data,” Genome Research, vol. 20, pp. 1297-1303, July 2010.
  
