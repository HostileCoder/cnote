2004 EEE Intemational Conference on Electric Utility Deregulation, Restructuring and Power Technologies (DRPT2004) April 2004 Hong Kong 
Automatic Power Quality Recognition System 
using Wavelet Analysis 
H.K. Siu, Member, IEE and H.W. Ngan, SrMember, IEEE 
Abstract-The quality of electricity has been gaining more 
emphasis among utilities, service sectors and consumers. They 
have to maintain the quality by strategic measures in coping 
with all sort of disturbances generated intrinsically in modern 
power electronic equipments, large commercial buildings and 
open power environment. A means of improving electric power 
quality starts by a systematic identiJication of the power system 
disturbances which is posed to be a big challenge. The 
conventional approach based on Fourier Transform principles 
has its main drawback of losing the time-domain feature a@er 
transformation. Whist the technique of using wavelet transform 
appears to be more promising with its strength on handling 
signals on short time intervals for high frequency components 
and long time intervals for  low frequency components. In this 
paper, an integrated approach, using both Fourier and wavelet 
transforms, is proposed and it is used to integrate the advantages 
of both transforms. The wavelet transform is used to extract the 
required time-domain information from the high frequency 
components while the Fourier transform is used to provide the 
accurate measurement from the low frequency components. An 
automatic power quality recognition system based on the 
integrated approach is develope& Neural network classifier and 
rule-based classijier are selected to implement the proposed 
approach of which its validation is performed via simulated 
data set. 
analyzers and harmonic analyzers, are typically used in the 
industry. These analyzers usually employ techniques 
based on point-by-point comparison of the rms values of 
the distorted signal with its corresponding pure signal, 
and/or transformation of the data into the frequency 
domain via Fourier transform (FT). 
However, the major problem of the traditional analyzing 
tools based on Fourier transform is that it will not provide 
sufficient information on the time domain. For non- 
stationary disturbances such as local transient signal, its 
location on the time axis will be lost after FT. 
One technique emerged to overcome the above 
mentioned problem is by using wavelet transform (WT) 
whose strength is on handling signals on short time 
intervals for high frequency components and long time 
intervals for low frequency components. By means of the 
strength, WT is considered suitable for analyzing signals 
with localized impulses and oscillations particularly for 
those commonly present in fundamental and low order 
harmonics. 
On the other hand, the IT still has its outstanding and 
well-proven performance on the measurement of the 
frequency spectrumof signals. As an integrated approach, 
the paper proposes to develop an automatic power quality 
recognition system by combining the advantages on both 
Index Terms-Power Quality, Fourier Transform, WT and FT. 
Wavelet Transform, Neural Network Classifier and Rule- 
Based Classifier. 11. FOURIER AND WAVELET TRANSFORMS 
I. INTRODUCTION A.  Fourier Transform 
VER the last two decades, emphasis on quality of 0 electricity has attracted 
utilities, service sectors and bulk consumers. Quality 
assurance of electricity supply by itself is a marketable 
product. The concern of power quality has also deeply 
founded with users of modern power electronic equipment 
The Fourier transform(FT), which breaks down a signal 
and attention to into constituent sinusoids of different frequencies, is 
perhaps the most well-known and reliable tool in signal 
analysis for many years. Mathematically, the FT is the sum 
Over time Of si@a1 X(t) by a 
as 
like those in commercial buildings which is sensitive to 
power system disturbances and/or those generated by 
itself. 
In order to monitor and control these disturbances, 
their systematic identification is essential which is posed 
to be a big challenge. Besides the primary methods based 
on visual inspection on the disturbance waveform, 
different monitoring devices, such as disturbance 
ca 
X (CO) = x(t)e-Jwrdt 
-ca 
For a sampled signal, the discrete Fourier transform 
with the DFT notation is defined as:- 
) 
X ( k )  = z x ( n ) e x p (  - j 2 x k n  
n = O  N 
where x(n) is a sequence of samples from a continuous 
time signal x(t) taken every t seconds for N samples. If the 
samples are uniformly spaced, the Fourier matrix can be 
0-7803-8237-4/04/$17.0002004IEEE 311 
factored into a product of just a few sparse matrices and 
the resulting factors can be applied to a vector in a total of 
order N log(N) arithmetic operations. This is the so-called 
Fast Fourier Transform (FFT). 
However, the FT was developed based on assumption 
that the original time-domain function is periodic in nature. 
As a result, when dealing. with functions with transient 
components that are localized in time, the FT cannot 
convey any time information about the transient 
components. In recent years, new families of orthonormal 
basis functions called "wavelets" have been discovered 
and new transforms have been developed to overcome the 
problem of the FT. 
B. Wavelet Transform 
Wavelet transform (WT) employs a basis function 
called the mother wavelet, usually denoted by Mt) which 
has a zero mean with sharp decays in an oscillatory 
fashion and effectively limited duration. Mathematically, 
the continuous wavelet transform (CWT) of a given signal 
x(t) is generally defined as:- 
where a is the dilation or scale factor, b is the translation 
factor, and both variables are continuous 
However, derivation of the CWT is quite time- 
consuming and computationally expensive and hence 
ineffective in terms of computation time for deriving its 
information content. As an improvement, the discrete 
wavelet transform (DWT) is developed by translating and 
dilating the mother wavelet discretely. The DWT is 
implemented by replacing a by aom and b by nboaom in (3) 
and applying summation over the sample space as shown 
in the following:- 
where n represents the translation step and m represents 
the scaling step and is known as the level number. If a,=2 
and bo=l,  then the transform is known as the dyadic 
orthonormal wavelet transform leading to an important 
technique called the multi-resolution signal decomposition 
(MSD) which will further be explained in the next section. 
By using another basic function, namely scaling 
function Nt) ,  a signal can be decomposed into two signals, 
i.e. the smoothed version with approximation coefficients 
c(k) and the detailed version with detailed coefficients d(k) 
as follows:- 
x(t> = C c ( k ) f i j , k , ( t )  + C d ( k ) w j , ) ( t )  ( 5 )  
k Z  k € Z  
provided that each scaling and wavelet function shall have 
an orthogonal basis as illustrated below : 
k e  Z 
c a Z k  = '  
k s  Z 
a 2 k + l  = 
k c Z  
where j denotes scale or resolution index, k denotes 
translation location index, and ak are the scaling 
coefficients. Equations (8) list out the set of scaling 
conditions which must be satisfied before a set of ak can 
be qualified as scaling coefficients. 
111. DETECTION OF POWER QUALITY DISTURBANCES 
A. Multi-resolution Signal Decomposition 
The multi-resolution signal decomposition (MSD) 
technique enables a signal x(t) to be decomposed into a 
hierarchical set of scaling functions @,k)(t) or O(t) with its 
approximation coefficients c(l), and shifted and dilated 
version of wavelet functions w,k)(t)  with its detail 
coefficients dQ, k) by decomposing the approximation 
coefficients at each level to get further approximation and 
detailed coefficients (see Fig. 1). 
Fig. 1. MSD algorithm 
In order to obtain the approximation and detail 
coefficients for each basis, we can take an inner product as 
given by 
2004 IEEE International Conference on Electric Utility Deregulation, Restructuring and Power Technologies (DRPT2004) April 2004 Hong Kong 
- .  
312 
2004 IEEE Intemational Conference on Electric Utility Deregulation, Restructuring and Power Technologies (DRPT2004) April 2004 Hong Kong 
In power quality (PQ) disturbance signals, many 
disturbances contain sharp edges, transitions and jumps. 
As proposed by many authors, like Gaouda [l], we can use 
the MSD technique to discriminate the sharp edges, 
transitions and jumps contained in the detailed version 
from the smoothed version such that they can be analyzed 
separately. A typical example, a 6-level MSD of a distorted 
signal with transient and harmonics, is shown in Fig. 2. 
For other different PQ problems, e.g. impulse, voltage 
sag, voltage swell, interruption, harmonics and transient, 
etc., the results of applying MSD technique are quite 
promising as illustrated in Fig. 3. 
. . " _  . .._. . . .__.  .,___ .. 
Fig. 2. 6-level MSD of a distorted signal with transient & harmonics 
(a) Imnulse (b) Voltaee sag 
(c) Voltage swell (d) Interruption 
Fig. 3 .  Results of applying MSD to different PQ problems 
(e )  Harmonics (0 Transient and harmonics 
Fig. 3. (cont.) Results of applying MSD to different PQ problems 
B. Integrated Approach 
In order to obtain more information of the distorted 
signals for further analysis, such as trending analysis and 
rectification of the PQ problem, etc., the rms measurement 
of the distorted signals are required as defined below:- 
I -  
According to Parseval' s theorem, if any function x(t) 
can be presented as a series expansion by using a 
combination of the scaling functions and wavelets which 
form an orthonormal basis as shown in (9). Then 
/(x(t)12 = y C ( 0 l '  + gpcx k)r (12) 
I €  Z ;=o k€Z 
Therefore, the energy of the distorted signal can be 
partitioned in terms of the approximation coefficients and 
the detail coefficients at different resolution levels. Then 
the rms measurement of the distorted signal can be derived 
as follows:- 
However, the decomposed waveform after MSD will 
provide non-uniform frequency bands that are in octave 
order. Hence, the MSD is not suitable to measure the rms 
values of individual harmonic components. Although 
Hamid, Kawasaki and Mardiana [SI proposed to use the 
wavelet packet transform WPT) algorithp which is a 
direct extension from the MSD algorithm to a full binary 
tree by decomposing both the detail and approximation 
coefficients to produce further coefficients, to overcome 
this limitation, errors still exist due to the roll-off 
characteristics of the selected wavelets. 
Therefore, an integrated approach using both the DWT 
and FFT algorithms is proposed in this paper for resolving 
the problem. In which, the distorted signal will first be 
decomposed into two signals, i.e. detailed and 
smoothed'approximated versions, by using the DWT 
algorithm The required time information such as the 
313 
2004 IEEE Intemational Conference on Electric Utility Deregulation, Restructuring and Power Technologies (DWT2004) April 2004 Hong Kong 
duration of the disturbance can now be extracted from the 
detailed version. The smoothed or approximated version 
will then be undergone the FFT algorithm in order to 
obtain the frequency spectrum of the distorted signal. This 
integrated approach is illustrated in Fig. 4. 
Distorted Signal n 
DWT / \ L 
FFT 1 
Fig. 4. Integrated approach by using both DWT & FFT algorithms 
With the same distorted signal containing transient and 
harmonics. the result is shown in Fig. 5 .  
(c) Detail D1 (d) Frequency spectrum 
Fig. 5.  Example of using integrated approach 
w. AUTOMATIC POWER QUALITY RECOGNITION 
SYSTEM 
In application, an automatic PQ recognition system is 
developed based on the proposed integrated approach. 
Although application of wavelet analysis for recognizing 
PQ disturbances has been addressed on a number of cases, 
like Gaouda [l], Negnevitsky [2] and Santoso [34], the 
proposed automatic PQ recognition system carries unique 
features such as it can be used for both detection and rms 
measurement for the PQ disturbances at the same time. 
A.  Proposed Classification Procedures 
According to the integrated approach, the proposed 
classification procedures are listed as followst 
Step 1 - The input signal is firstly decomposed into the 
detail coefficients (cD 1) and the approximation 
coefficients (cAl) by using DWT. 
Step 2 - The approximation coefficients (cAl) is 
transformed to frequency domain by using FFT. 
Step 3 - Based on the result obtained after using FFT, the 
following features can be determined:- 
i) DC component ( Vdc) 
ii) 
iii) 
iv) 
Step4- Then the detail coefficients (cD1) will be de- 
noised by applying threshold. 
Step 5 - Based on the time information about the 
disturbances extracted from the de-noised detail 
coefficients (cDI), the frequency spectrums 
before and after the transition can be measured 
via FFT and then the following features due to 
the presence of disturbance can be determined:- 
i) Change of rms value of fundamental 
component (AV,) 
ii) Disturbance duration (A$ 
iii) Change of DC component (AvdJ  
iv) Change of THD ratio ( A t h d )  
Step 6 - The features obtained in Steps 3 and 5 will be 
passed to the classifier in order to identify the 
nature of the disturbance. 
In this paper, two classifiers called rule-based classifier 
and neural network classifier will be employed to 
implement the automatic PQ recognition system. 
B. Rule-Based Classijier 
Basically, the PQ disturbances can be divided into two 
categories, i.e. short duration variations and long duration 
variations. Referring to the features measured in Step 3, 
the following long duration variations can be easily 
identified. 
Rms value of fundamental component ( V I )  
Total harmonic distortion (THD) ratio ( thd)  
Change of fundamental frequency (4 
i) Harmonics ( i f thd threshold) 
ii) DC offset (if& > threshold) 
iii) Frequency variation (ifabs(dF) > threshold) 
In order to classify the short duration variations, the 
characteristics of the disturbances are investigated via 
measuring and comparing the frequency spectrums before 
and after the transition of the disturbance. The differences 
between two measured spectrums are plotted in Fig. 6. 
I 
I 
- ~ - - ;   ---I. " -  
( c )  Transient (d) Difference of spectrums for transient 
Fig. 6 .  Characteristics of short duration variations 
314 
2004 IEEE International Conference on Electric Utility Deregulation, Restructuring and Power Technologies (DRPT2004) April 2004 Hong Kong 
TRANSIENT d 
~. 
Fig. 6 .  (cont.) Characteristics of short duration variations 
4 4 
TABLE I1 
INPUTS AND OUTPUTS OF NEURAL NETWORK CLASSIFIER 
INPUT FEATURES TYPE OF DISTURBANCES TO BE 
DETECTED (OUTPUTS) 
IMPULSIVE TRANSIENT 
OSCILLATORY TRANSIENT 
THD VOLTAGE SAG 
TRANSIENT 
VOLTAGE SAG, 
SWELL & 
INTERRUPTION 
AF I VOLTAGE WELL 
AV, INTERRUPTION 
4 
4 
I A 7  I HARMONICS I 
From Fig. 6, the characteristics of the differences 
between two measured spectrums for different 
disturbances are observed and summarized in Table I. 
TABLE I 
SUMMARY OF CHARACTERISTICS OF SHORT DURATION VARIATIONS 
I TYPE O F  I CHANGEOF I CHANGEOF I CHANGEOF 
DISTURBANCES I VDC I v, I THD 
IMPULSIVE I 
According to results shown in Table I and the IEEE Std. 
1159 [7], the features extracted from Step 5 can be used to 
classify the short duration variations as follows:- 
i) Impulse ($AV,, > threshold) 
ii) Transient ( i f d t h d  > threshold) 
iv) Voltage swell (ifZO%<Avl -GO%) 
iii) Voltage sag (if-9O%<Av] <-IO%) 
v) Interruption ( I ~ A v ~  <-90%) 
Based on the above classification criteria, a rule-based 
classifier can be constructed to identify the disturbances. 
C. Neural Network Classijier 
Pattern recognition techniques are basically divided 
into two types, i.e. parametric approach and non- 
parametric approach. The previous rule-based classifier 
obviously belongs to the former type. However, the 
parametric approach usually requires a prior statistical 
assumption which is not precisely known in many 
situations and the set of example data is not sufficiently 
large. Similar to the rule-based classifier, the thresholds for 
different classification criteria should be well defined 
based on the prior statistical assumption before the 
classifier can perform the job satisfactorily. Therefore, a 
non-parametric approach such as neural network classifier 
can be considered as an alternative proposal. 
As there are 8 features extracted in Steps 3 and 5, and 8 
types of dis turbances to be detected as listed in Table 11, a 
two-layer perceptron neural network (see Fig. 7) with 8 
input neurons and 8 output neurons is adapted to 
implement the classification. 
I AVK I DC OFFSET ATHD I FREQUENCY VARIATION 
8 8 8 
Fig. 7 .  Two-layer perceptron neural network classifier 
D. Training and Verification 
In order to train the neural network classifier and verify 
the rule-based operation, a set of simulated disturbance 
waveforms is generated as proposed by Liao [6] as listed 
in Table 111. After passed the input features extracted from 
the generated waveforms and the target outputs to the 
neural network classifier, the training result is plotted in 
Fig. 8. Referring to the training result, the error of the 
neural network classifier has dropped to 6.932~10-l~ just 
after 31 epochs. 
TABLE 111 
SIMULATED WAVEFORMS GENERATED FOR TRAINING & 
VERIFICATION 
(I)  FREQUENCY VARIATION 
COMBINATION F (B)+(G)+(H)+(I) 
COMBINATION OF (e)+( G)+( H)+(I) 
COMBlNATlON OF (D)+(G)+(H)+(I) 2 %  
COMBINATION F (E)+(G)+(H)+(I 2% 
O%, 2%, 5% 
  COMBINATION OF (F)+(B)+(c)+(G) I 2 %  I 3 I 
I TOTAL :I 42 I 
Fig. 8. Plot of error of neural network classifier 
315 
2004 IEEE Intemational Conference on Electric Utility Deregulation, Restructuring and Power Technologies (DRPT2004) April 2004 Hong Kong 
At the same time, the simulated waveforms are passed 
to the rule-based classifier for verification. After adjusting 
the thresholds, the rule-based classifier could recognize all 
the disturbances contained in the simulated waveforms. 
Therefore, the performance of the neural network classifier 
and the rule-based classifier are quite satisfactory. 
v. CONCLUSION 
In short, the automatic PQ recognition system is 
developed by using the proposed integrated approach, i.e. 
by using DWT and FFT. It can perform both the extraction 
of the required time information and the rms measurement 
of the distorted signal. The performance of the two 
proposed classifiers, namely rule-based classifier and 
neural network classifier, are also demonstrated and 
verified by a set of simulated disturbance waveforms. 
Although the test result of the proposed automatic PQ 
recognit ion system is quite promising, the real-life PQ 
disturbance data will not be as simple as those simulated 
waveforms and the size of sampled waveforms is hard to 
be sufficiently large. Therefore, further adjustment and 
modification is required before this proposed automatic PQ 
recognition system can be applied in real-life situation. 
W. ACKNOWLEDGMENT 
The authors gratefully acknowledge the contributions 
of Prof. David Zhang and Prof. K.P. Wong for their expert 
advices and guidance. 
w. REFERENCES 
A.M. Gaouda, M.M.A. Salama, M.K.Sultan and A.Y. Chikhani, 
”Power Quality Detection and Classification Using Wavelet- 
Multiresolution Signal Decomposition,” IEEE Trans. On 
Power Delivery, Vol. 14, No. 4, Oct. 1999, pp. 1469-1476. 
Jiansheng Huang, Michael Negnevitsky and D. Thong Nguyen, 
“A Neural-Fuzzy Classifier for Recognition of Power Quality 
Disturbances,” IEEE Trans. On Power Delivery, Vol. 17, No. 2, 
Apr. 2002, pp. 609-616. 
Surya Santoso, Edward J. Powers, W.Mack Grady and Antony 
C. Parsons, “Power Quality Disturbance Waveform 
Recognition Using Wavelet-Based Neural Classifier - Part 1: 
Theoretical Foundation,” IEEE Trans. On Power Delivery, 
Vol. 15, No. 1, Jan. 2000, pp. 222-228. 
Surya Santoso, Edward J. Powers, W.Mack Grady and Antony 
C. Parsons, “Power Quality Disturbance Waveform 
Recognition Using Wavelet-Based Neural Classifier - Part 2: 
Application,” IEEE Trans. On Power Delivery, Vol. 15, No. 1, 
Jan. 2000, pp. 229-235. 
Effrina Yanti Hamid, Zen-Ichiro Kawasaki and Redy Mardiana, 
“Wavelet Packet Transform for Rms and Power 
Measurements“ in 2001 IEEE Power Engineering Society 
Summer Meeting, 15-19 Jul. 2001, pp. 1243-1245, Vol. 2. 
M. Kezunovic and Y. Liao, “ A  novel method for equipment 
sensitivity study during power quality events”, in Proceedings 
of IEEE Power Engineering Society Winter Meeting, Singapore, 
January 2000. pp. 230-235. 
IEEE Recommended Practices for Monitoring Electric Power 
Quality, IEEE Standard 1159-1995, 1995. 
VIII. BIOGRAPHIES 
Ir. H.K. Siu received his B Eng in 1988 and 
M Sc in 1995 from the Hong Kong 
Polytechnic University and the University of 
Hong Kong respectively After graduated from 
the Hong Kong Polytechnic University, he 
joined the Electrical and Mechanical Services 
Department, HKSAR, as an Engineer Trainee 
and then continued as an Assistant Building 
Services Engineer. Since 1994, he was promoted to Building 
Services Engineer, and now, he mainly works for the E&M 
maintenance of Government buildings He is also pursuing the study 
of EngD course offered by the Hong Kong Polytechnic University, 
and his research topic is about the detection of power quality 
disturbances and its application on the maintenance of commercial 
buildings 
Dr. H.W. Ngan received his M.Sc in 1979, 
MBA in 1985 and PhD in 1993 from the 
University of Aston in Birmingham. University 
of Hong Kong and University of Strathclyde 
respectively. He is now with the Hong Kong 
Polytechnic University as the Associate 
Professor in the Department of Electrical 
Engineering. His current research interests include Power Market 
Reform, Power System Analysis, FACTS system control strategies, 
Energy Policy and Planning. 
316 
